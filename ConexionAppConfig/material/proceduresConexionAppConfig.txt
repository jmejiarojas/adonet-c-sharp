SELECT * FROM SYS.DATABASES
WHERE NAME LIKE 'NEGOCIOS%'
GO

USE NEGOCIOS2016
GO

SELECT * FROM SYS.TABLES
GO

SP_HELP 'VENTAS.CLIENTES'
GO

SELECT * FROM VENTAS.clientes
GO

/*
Vamos a mostrar a los clientes, indicando tambien el nombre del pais al que pretenecen
*/

SELECT * FROM VENTAS.PAISES
GO


CREATE PROCEDURE SP_LISTADO_CLIENTES
AS
BEGIN
SELECT C.IdCliente, C.NomCliente, C.DIRCLIENTE, P.NOMBREPAIS
FROM VENTAS.clientes C
JOIN VENTAS.paises P ON C.idpais=P.Idpais
END
GO

EXEC SP_LISTADO_CLIENTES
GO

SELECT COUNT(*)
FROM VENTAS.CLIENTES
GO

SELECT * FROM SYS.TABLES
GO

SELECT * FROM COMPRAS.PRODUCTOS
GO


CREATE PROCEDURE SP_PRODUCTOS_NOMBRE
@NOMBRE VARCHAR(100)
AS
BEGIN
SELECT P.IdProducto, P.NomProducto,P.PrecioUnidad, C.NombreCategoria, PR.NomProveedor 
FROM COMPRAS.PRODUCTOS P
JOIN COMPRAS.PROVEEDORES PR ON P.IDPROVEEDOR = PR.IDPROVEEDOR
JOIN COMPRAS.CATEGORIAS C ON C.IdCategoria = P.IdCategoria
WHERE P.NomProducto LIKE '%'+ @NOMBRE +'%'
END
GO

EXEC SP_PRODUCTOS_NOMBRE 'ME'
GO